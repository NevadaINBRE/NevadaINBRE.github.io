<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />




<title>Reproducible Data Science</title>

<script src="site_libs/header-attrs-2.17/header-attrs.js"></script>
<script src="site_libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/bootstrap.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<style>h1 {font-size: 34px;}
       h1.title {font-size: 38px;}
       h2 {font-size: 30px;}
       h3 {font-size: 24px;}
       h4 {font-size: 18px;}
       h5 {font-size: 16px;}
       h6 {font-size: 12px;}
       code {color: inherit; background-color: rgba(0, 0, 0, 0.04);}
       pre:not([class]) { background-color: white }</style>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<link href="site_libs/highlightjs-9.12.0/default.css" rel="stylesheet" />
<script src="site_libs/highlightjs-9.12.0/highlight.js"></script>
<link href="site_libs/font-awesome-5.1.0/css/all.css" rel="stylesheet" />
<link href="site_libs/font-awesome-5.1.0/css/v4-shims.css" rel="stylesheet" />

<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>

<style type="text/css">code{white-space: pre;}</style>
<script type="text/javascript">
if (window.hljs) {
  hljs.configure({languages: []});
  hljs.initHighlightingOnLoad();
  if (document.readyState && document.readyState === "complete") {
    window.setTimeout(function() { hljs.initHighlighting(); }, 0);
  }
}
</script>









<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
img {
  max-width:100%;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
details > summary > p:only-child {
  display: inline;
}
pre code {
  padding: 0;
}
</style>


<style type="text/css">
.dropdown-submenu {
  position: relative;
}
.dropdown-submenu>.dropdown-menu {
  top: 0;
  left: 100%;
  margin-top: -6px;
  margin-left: -1px;
  border-radius: 0 6px 6px 6px;
}
.dropdown-submenu:hover>.dropdown-menu {
  display: block;
}
.dropdown-submenu>a:after {
  display: block;
  content: " ";
  float: right;
  width: 0;
  height: 0;
  border-color: transparent;
  border-style: solid;
  border-width: 5px 0 5px 5px;
  border-left-color: #cccccc;
  margin-top: 5px;
  margin-right: -10px;
}
.dropdown-submenu:hover>a:after {
  border-left-color: #adb5bd;
}
.dropdown-submenu.pull-left {
  float: none;
}
.dropdown-submenu.pull-left>.dropdown-menu {
  left: -100%;
  margin-left: 10px;
  border-radius: 6px 0 6px 6px;
}
</style>

<script type="text/javascript">
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark the anchor link active (and if it's in a dropdown, also mark that active)
  var dropdown = menuAnchor.closest('li.dropdown');
  if (window.bootstrap) { // Bootstrap 4+
    menuAnchor.addClass('active');
    dropdown.find('> .dropdown-toggle').addClass('active');
  } else { // Bootstrap 3
    menuAnchor.parent().addClass('active');
    dropdown.addClass('active');
  }

  // Navbar adjustments
  var navHeight = $(".navbar").first().height() + 15;
  var style = document.createElement('style');
  var pt = "padding-top: " + navHeight + "px; ";
  var mt = "margin-top: -" + navHeight + "px; ";
  var css = "";
  // offset scroll position for anchor links (for fixed navbar)
  for (var i = 1; i <= 6; i++) {
    css += ".section h" + i + "{ " + pt + mt + "}\n";
  }
  style.innerHTML = "body {" + pt + "padding-bottom: 40px; }\n" + css;
  document.head.appendChild(style);
});
</script>

<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before, .tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "\e259";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "\e258";
  font-family: 'Glyphicons Halflings';
  border: none;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
  background-color: transparent;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<!-- code folding -->




</head>

<body>


<div class="container-fluid main-container">




<div class="navbar navbar-default  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-bs-toggle="collapse" data-target="#navbar" data-bs-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">Nevada INBRE DSCore</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="index.html">
    <span class="fa fa-home"></span>
     
    Home
  </a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Workshops
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li class="dropdown-header">Upcoming</li>
    <li class="dropdown-header">Previous</li>
    <li>
      <a href="bootcamp-r-series.html">2021 Summer: R for Data Science at UNR</a>
    </li>
    <li>
      <a href="bootcamp-supervised-ml-2022-10.html">2022 Fall: Python for ML at UNR</a>
    </li>
    <li>
      <a href="bootcamp-supervised-ml-2023-01.html">2023 Winter: Python for ML at UNR</a>
    </li>
    <li>
      <a href="NSC_ResearchDay_2023-03.html">2023 Spring: Research Day at NSC</a>
    </li>
    <li>
      <a href="bootcamp-intro-R_2023-03.html">2023 Spring: Programming with R at UNR</a>
    </li>
    <li>
      <a href="CSN_phageGenomics_2023-03.html">2023 Spring: Phages Genomics at CSN</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Tutorials
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="jupyter-notebook-setup.html">Jupyter Notebook</a>
    </li>
    <li>
      <a href="NSC_IntrotoR.html">R</a>
    </li>
    <li class="dropdown-header">Julia</li>
    <li class="dropdown-header">Python</li>
  </ul>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="about.html">
    <span class="fa fa-address-book"></span>
     
    About
  </a>
</li>
<li>
  <a href="https://github.com/NevadaINBRE">
    <span class="fa fa-code-branch"></span>
     
  </a>
</li>
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div id="header">



<h1 class="title toc-ignore">Reproducible Data Science</h1>

</div>


<div id="introductions-and-overview" class="section level2">
<h2>Introductions and Overview</h2>
</div>
<div id="examples-of-bad-habits" class="section level2">
<h2>Examples of bad habits</h2>
<ul>
<li>Having files, data, code, and documentation all scattered in
different locations</li>
<li>Using excel to store, modify, and visualize data</li>
<li>Doing version control by copying and renaming files</li>
<li>Not documenting or commenting code</li>
</ul>
</div>
<div id="a-few-scenarios" class="section level2">
<h2>A few scenarios</h2>
<blockquote>
<p>You have data saved in an excel sheet, and proceed to open it up,
create some new columns using excel functions, remove various rows, and
fill in missing values with zeros. A few weeks later, the criteria for
missing values changes. You can’t remember which zeros were genuine, and
which were originally missing. Furthermore, the removed rows are
acutally necessary and they’re gone! Hopefully the originally collected
data is somewhere and unmodified.</p>
</blockquote>
<p><em>Problem</em>: there is no good way to track the changes that have
been made to an excel sheet.</p>
<p><em>Solution</em>: treat data as immutable, and use scripts to make
procedural changes to the data.</p>
<blockquote>
<p>You decide that doing everything in excel is a bad idea, and instead
write a script to process the data. You know it’s good to keep backups
of files, so every time your script changes, you save it as a new file.
You now have <code>process_data.R</code>, <code>process_data2.R</code>,
<code>process_data_new.R</code>, and
<code>process_data_20210505.R</code> as files. You send the code to a
friend to review, and they send you back
<code>process_data_20210507.R</code> as their modified version. Two
months later you come back to these files because you can reuse some of
the code, but you’re not sure which one is the most up to date. You
spend the rest of the day reading through the code of each file looking
for differences.</p>
</blockquote>
<p><em>Problem</em>: duplicating files can lead to confusion, and
changes are not tracked over time.</p>
<p><em>Solution</em>: utilize a source control management system (like
Git or SVM) to always have access to past versions and keep track of the
most recent version.</p>
<blockquote>
<p>You have a research project that requires data downloaded from the
internet. It’s pretty large, so you download it once and leave it in
your downloads folder as <code>data.txt</code>. You also have some
common functions that you reuse for other projects in your documents
folder. Your code references the data and other scripts using absolute
file paths
(e.g. <code>/home/Hogarth/Documents/code/model_fitting.R</code> and
<code>/home/Hogarth/Downloads/data.txt</code>). You want to share this
project with a classmate, but when you send the files, the code no
longer works for them.</p>
</blockquote>
<p><em>Problems</em>: the project is not self-contained, and absolute
file paths make it harder to run code on another PC.</p>
<p><em>Solution</em>: create a project directory (and project file if
possible) and keep it self contained. Large data sets can be stored on a
separate website and downloaded with a script. Reused code should be
accessible (e.g. in a GitHub repository).</p>
<p><strong>A worst case scenario</strong></p>
<p>From <em><a
href="https://towardsdatascience.com/creating-reproducible-data-science-projects-1fa446369386">Towards
Data Science</a></em>:</p>
<blockquote>
<p>Imagine you completed a one-off analysis a few months ago, creating a
fairly complex data pipeline, machine learning model, and
visualizations. Fast forward to today and you have Emily, a senior
executive at your company, asking you to reuse that work to help solve a
similar, time-critical business problem. She looks stressed.</p>
</blockquote>
<blockquote>
<p>Now if only you could remember which copy of your model was the
correct one; if you could make sense of the spaghetti code scattered
throughout your Jupyter Notebooks, each with helpful names such as
Untitled_1 and Untitled_2; what did the <code>data_process</code>
function do and why are there six slightly different versions of it? If
only there was some documentation!</p>
</blockquote>
<blockquote>
<p>“No problem!” you assure her, and after a few sleepless nights,
during which you had to reverse engineer the entire codebase, the
analysis is ready. Emily looks impressed, that promotion you’ve been
waiting for might finally happen.</p>
</blockquote>
<blockquote>
<p>The next day Emily is back from presenting your findings. She’s not
happy – apparently there were mistakes in the analysis caused by simple
coding errors that could have cost the company millions. If only you had
run some tests! You apologise as she walks away muttering under her
breath, you sit there and wonder if maybe you should pack up your desk
before you head home for the night.</p>
</blockquote>
</div>
<div id="principles-of-reproducible-data-science"
class="section level2">
<h2>Principles of reproducible data science</h2>
<ul>
<li>Keeping to a common project structure</li>
<li>Creating self-contained projects</li>
<li>Documenting everything</li>
<li>Using version control</li>
<li>Utilizing tools to produce dynamic and parameterized reports</li>
<li>Splitting up reusable code into separate modules</li>
<li>Treating data as an immutable object</li>
</ul>
</div>
<div id="organizing-a-new-project" class="section level2">
<h2>Organizing a new project</h2>
<ul>
<li>Let’s walk through an example of setting up a new data science
project in R (and maybe Python)</li>
<li>We will be using RStudio for R
<ul>
<li>We will be using Visual Studio Code for Python</li>
<li>Julia and other languages with no designated IDE can likely use the
same general template as Python</li>
<li>Visual Studio Code has support for many languages, and has an
integrated terminal to run code</li>
</ul></li>
</ul>
<div id="setting-up-version-control" class="section level3">
<h3>Setting up version control</h3>
<p>It is important to first decide on the source control management
system that you will be using. Cloud storage services like Google Drive,
OneDrive, Box, and dropbox usually offer a limited form of version
history. This can be used as a <em>minimum</em> form of backup and
version control. A more powerful and flexible solution is to learn a
source control management (SCM) system such as Git or SVM. Services like
GitHub, GitLab, and Bitbucket use Git to host <em>repositories</em>, or
projects that others can view or contribute to.</p>
<p>When starting a new project using SCM, it is often easier to first
create the <em>repo</em> (short for repository) on GitHub (or whichever
service you decide to use), <em>clone</em> the repo (download to your
PC), and then begin adding files. For beginners, it is also easier to
use a git graphic user interface (GUI). Git relies on terminal commands,
but a GUI can lower the barrier to entry for those less confident with
using a terminal. Common GUI applications are:</p>
<ul>
<li>GitKraken [cross-platform] [free and pro versions] [my personal
choice]
<ul>
<li>free version only allows for public repos</li>
</ul></li>
<li>GitHub Desktop [Windows, Mac] [free]</li>
<li>Sourcetree [Windows, Mac] [free]</li>
</ul>
<p>For simple projects with only a couple of contributors, a GUI
application can work fine. For more complex projects with many
contributors, it is recommended to become familiar with using git in a
terminal (command line interface – CLI).</p>
<div id="creating-a-github-repository" class="section level4">
<h4>Creating a GitHub Repository</h4>
<p><em>It is assumed that you have created a GitHub account.</em></p>
<ul>
<li>Open <a href="https://github.com/">GitHub.com</a></li>
<li>Start creating a new repo
<ul>
<li>There is a “new” button on the left and a “+” button at the top
right</li>
</ul></li>
<li>Choose a project (repository) name (no spaces)</li>
<li>Make it public or private
<ul>
<li>a private repo may not be supported by all free Git GUI’s</li>
</ul></li>
<li>Optional
<ul>
<li><code>README.md</code> is a special file that gets rendered in
Markdown and is displayed to anyone who may view your repo (<a
href="https://github.com/tidyverse/dplyr#readme">see here</a> for an
example)</li>
<li><code>.gitignore</code> is a file recognized by git that allows you
to optionally ignore (not keep track of) files that match a specified
pattern (e.g. a folder name or path, log files, etc.)</li>
<li>Choose a license so that others know what they can and cannot do
with your work</li>
</ul></li>
</ul>
<video width="100%" autoplay muted loop controls>
<source src="media/vid/03-creating-github-repo.webm" type="video/webm">
</video>
</div>
<div id="cloning-a-github-repository" class="section level4">
<h4>Cloning a GitHub Repository</h4>
<ul>
<li>Download and install the GitHub Desktop app</li>
<li>Select the “Clone a Repository” button and browse to the newly
created repo</li>
<li>Select a download location (recommend creating a Projects
folder)</li>
</ul>
<video width="100%" autoplay muted loop controls>
<source src="media/vid/03-cloning-github-repo.webm" type="video/webm">
</video>
<p>“Cloning” essentially means that you are downloading the repository
to your <em>local machine</em> from the <em>remote host</em>.</p>
</div>
<div id="other-resources" class="section level4">
<h4>Other resources</h4>
<ul>
<li><a href="https://git-scm.com/">git</a> (the underlying SCM
software)</li>
<li><a href="https://github.com/">GitHub</a> (repo host)</li>
<li><a href="https://about.gitlab.com/">GitLab</a> (repo host)</li>
<li><a href="https://bitbucket.org/product">Bitbucket</a> (repo host)
<ul>
<li>Part of the Atlassian group (Trello, Jira, Sourcetree)</li>
</ul></li>
<li><a href="https://sethrobertson.github.io/GitBestPractices/">git best
practices</a> (reference)</li>
<li><a
href="https://datasift.github.io/gitflow/IntroducingGitFlow.html">GitFlow</a>
branching model (reference)</li>
<li><a href="https://choosealicense.com/">Choose a license</a>
explanation of various common software licenses</li>
</ul>
</div>
</div>
<div id="start-thinking-about-a-project-oriented-workflow"
class="section level3">
<h3>Start thinking about a project-oriented workflow</h3>
<p>In a “project-oriented” workflow, your IDE can manage the project by
automatically setting the working directory whenever the project is
opened. In RStudio, this is done with an R Project file
(<code>.Rproj</code>).</p>
<p>By letting your IDE manage the project and the working directory, you
can set relative file paths ensuring that everything will work even if
the project is opened on another computer. In general, the working
directory should be the top level project directory, and all paths
should be relative to that.</p>
<p>In the video below, we create a new project from the repository that
we cloned earlier.</p>
<video width="100%" autoplay muted loop controls>
<source src="media/vid/03-creating-project-from-folder.webm" type="video/webm">
</video>
<div id="optional-set-up-a-virtual-environment" class="section level4">
<h4>(Optional) Set up a virtual environment</h4>
<p>A virtual environment is a fancy way to describe a system of managing
package versions and other dependencies. In R, there is a library called
<code>renv</code> that can keep track of libraries installed and used in
a project, and can restore the packages when the project is opened on a
different computer. This can greatly contribute to reproducibility.</p>
<video width="100%" autoplay muted loop controls>
<source src="media/vid/03-using-renv.webm" type="video/webm">
</video>
</div>
<div id="other-resources-1" class="section level4">
<h4>Other resources</h4>
<ul>
<li><a href="https://rstats.wtf/project-oriented-workflow.html">What
They Forgot to Teach you About R</a></li>
<li><a href="https://stat545.com/r-basics.html">R basics and
workflows</a></li>
<li><a
href="https://www.tidyverse.org/blog/2017/12/workflow-vs-script/">tidyverse:
Project-oriented workflow</a></li>
<li><a
href="https://community.rstudio.com/t/project-oriented-workflow-setwd-rm-list-ls-and-computer-fires/3549/2">RStudio
community: Project-oriented workflow</a></li>
</ul>
</div>
</div>
<div id="create-the-project-structure" class="section level3">
<h3>Create the project structure</h3>
<p>When all project folders are organized in the same way, the time
spent searching for files is greatly reduced.</p>
<pre><code>├── LICENSE
├── README.md      &lt;- The top-level README for developers using this project.
├── data           
│   ├── external   &lt;- Data from third party sources.
│   ├── interim    &lt;- Intermediate data that has been transformed.
│   ├── processed  &lt;- The final, canonical data sets for modeling.
│   └── raw        &lt;- The original, immutable data dump.
│                  
├── docs           &lt;- A default Sphinx project; see sphinx-doc.org for details
│                  
├── models         &lt;- Trained and serialized models, model predictions, 
│                     or model summaries
│                  
├── notebooks      &lt;- R notebooks. Naming convention is a number (for ordering),
│                     the creator&#39;s initials, and a short `-` delimited 
│                     description, e.g. `1.0-jqp-initial-data-exploration`.
│                  
├── references     &lt;- Data dictionaries, manuals, and all other explanatory materials.
│                  
├── reports        &lt;- Generated analysis as HTML, PDF, LaTeX, etc.
│   └── figures    &lt;- Generated graphics and figures to be used in reporting
│                  
├── R              &lt;- R scripts
│                  
└── scratch        &lt;- Other scratch files for testing, etc.</code></pre>
</div>
<div id="committing-changes-to-github" class="section level3">
<h3>Committing Changes to GitHub</h3>
<p>When you create new files and folders in your github project, they
are not automatically tracked. Files need to be “staged” and then
“committed”. Finally, commits need to be “pushed” to the remote location
(GitHub) in order to be backed up.</p>
<p>This leads to a simple workflow:</p>
<ol style="list-style-type: decimal">
<li>write code, add files, etc.</li>
<li>stage the changes in GitHub Desktop</li>
<li>write a useful commit message</li>
<li>repeat steps 1-3 throughout the day</li>
<li>push the changes to remote</li>
</ol>
<p>It’s a good idea to commit early and commit often. Git works by
tracking the <em>differences</em> between commits, so there’s no need to
worry about having too many commits that take up a lot of memory.</p>
<video width="100%" autoplay muted loop controls>
<source src="media/vid/03-committing-changes.webm" type="video/webm">
</video>
</div>
</div>
<div id="coding-practices" class="section level2">
<h2>Coding practices</h2>
<div id="re-using-code" class="section level3">
<h3>Re-using code</h3>
<ul>
<li>functions</li>
<li>creating a user library</li>
<li>implement simple, composable functions</li>
</ul>
</div>
<div id="writing-human-readable-code" class="section level3">
<h3>Writing human-readable code</h3>
<blockquote>
<p>Debugging is twice as hard as writing the code in the first place.
Therefore, if you write the code as cleverly as possible, you are, by
definition, not smart enough to debug it. – Brian Kernighan</p>
</blockquote>
</div>
<div id="writing-comments" class="section level3">
<h3>Writing comments</h3>
<p>In a perfect world, code should be self-documenting. For example, the
following code should be (relatively) easy to reason about:</p>
<pre class="r"><code>df_raw   &lt;- read_raw_temperature_data(&quot;path/to/file.txt&quot;)
df_clean &lt;- parse_raw_temperature_data(df_raw)

write.csv(df_clean, file = &quot;data/processed/temperature_2020.csv&quot;)

p &lt;- plot_temperature_by_month(df_clean)</code></pre>
<p>The specifics of what each function is doing is hidden from us, the
reader, but it’s clear that this program reads in raw data, cleans it up
in some way, writes the clean data back to a new file, and then produces
a plot. No comments are required in this code.</p>
<p>However, sometimes comments are necessary to further explain the
reasoning behind code. For example, a perfect power number is an integer
that can be written in the form of <span class="math inline">\(a^b =
m\)</span> where <span class="math inline">\(a\)</span>, <span
class="math inline">\(b\)</span>, and <span
class="math inline">\(m\)</span> are integers, and <span
class="math inline">\(b \ge 2\)</span>. Here is a function that checks
if a number is a perfect power:</p>
<pre class="r"><code>is_perfect_power &lt;- function(n) {
  p &lt;- numbers::primeFactors(n)
  e &lt;- table(p)
  
  if (length(e) == 1 &amp;&amp; e &gt; 1)
    return(TRUE)
  
  if (!all(e &gt; 1))
    return(FALSE)
  
  if (numbers::mGCD(e) == 1)
    return(FALSE)
  
  TRUE
}

is_perfect_power(81)  # 3^4</code></pre>
<pre><code>## [1] TRUE</code></pre>
<pre class="r"><code>is_perfect_power(72)  # 2^3 * 3^2</code></pre>
<pre><code>## [1] FALSE</code></pre>
<pre class="r"><code>is_perfect_power(144) # 2^4*3^2 -&gt; 2^2*2^2*3^2</code></pre>
<pre><code>## [1] TRUE</code></pre>
<p>As it is, it is difficult to understand what it is doing or why it is
doing it. Let’s break down the logic. If <span
class="math inline">\(m\)</span> is a perfect power, then it can be
written as <span class="math inline">\(a^b\)</span>. If <span
class="math inline">\(a\)</span> is not prime, then it can further be
written as <span class="math inline">\((f \cdot g)^b \Rightarrow f^b
\cdot g^b\)</span>. We can keep breaking down <span
class="math inline">\(a\)</span> into its prime factors, and each prime
factor will have an exponent associated with it (number of times the
prime factor is present). For example,</p>
<p><span class="math display">\[48 \rightarrow 6\cdot 8 \rightarrow 2
\cdot 3 \cdot 2 \cdot 2 \cdot 2 \rightarrow 2^4 \cdot 3^1\]</span></p>
<pre class="r"><code>numbers::primeFactors(48)</code></pre>
<pre><code>## [1] 2 2 2 2 3</code></pre>
<pre class="r"><code>table(numbers::primeFactors(48))</code></pre>
<pre><code>## 
## 2 3 
## 4 1</code></pre>
<p>So we see that the first two lines in the function are computing the
prime factors, and then counting each prime (getting the exponents).</p>
<p>The first test checks to see if there is only one prime factor of the
number (like the number 27). If so, then check to see if the exponent is
greater than or equal to 2 (see the definition of perfect power above).
In this case, the number must be a perfect power, and we can return
<code>TRUE</code>.</p>
<p>The second test then checks to see if all the exponents are greater
than or equal to 2. If not, then we can eliminate the given number as a
possible perfect power.</p>
<p>The final check is tricky. If the greatest common divisor between two
(or more) numbers is 1, then they are relatively prime (share no common
factor). In this case, the number cannot be written as a perfect power.
Take 144 as an example.</p>
<p><span class="math display">\[144 \rightarrow 2^4 \cdot
3^2\]</span></p>
<p>The exponents are not all the same, but the GCD of 4 and 2 is 2, so
the number can be written as</p>
<p><span class="math display">\[2^2 \cdot 2^2 \cdot 3^2 \rightarrow
(2\cdot 2\cdot 3)^2 \rightarrow 12^2\]</span></p>
<p>which we can then see is a perfect power. We cannot do this same
process if the GCD is 1.</p>
<p>Let’s now add some comments to the function to make it more
understandable:</p>
<pre class="r"><code># a perfect power is a number that can be written as `a^b` where `a` and `b` are positive
# integers and `b &gt;= 2`
is_perfect_power &lt;- function(n) {
  # computes the prime factorization and gets the exponent associated with each prime
  p &lt;- numbers::primeFactors(n)
  e &lt;- table(p)
  
  # if there is only one prime factor, then its exponent must be &gt;= 2
  # e.g. 81 -&gt; 3^4 -&gt; perfect power
  # e.g. 23 -&gt; 23^1 -&gt; not a perfect power
  if (length(p) == 1 &amp;&amp; e &gt;= 2)
    return(TRUE)
  
  # if there are more than one prime factors, all exponents must be &gt;= 2 by definition
  if (!all(e &gt;= 2))
    return(FALSE)
  
  # if the GCD of the exponents is 1, then the number cannot be written in a way where the
  # exponents of all factors are the same
  # e.g.  144 -&gt; 2^4*3^2 GCD(4, 2) = 2 -&gt; 2^2*2^2*3^2 -&gt; (2*2*3)^2 -&gt; perfect power
  # e.g. 1944 -&gt; 2^3*3^5 -&gt; GCD(3, 5) = 1 -&gt; not a perfect power
  if (numbers::mGCD(e) == 1)
    return(FALSE)
  
  # if we&#39;ve made it to here, then by process of elimination the number is a perfect power
  TRUE
}</code></pre>
<p>At this point, our function now has more comments than code, which
means that we may be better off writing a longer description above the
function and cutting out some of examples in the code. The main idea is
that your future self should be able to come and read the code you’ve
written and understand what is being done and why.</p>
<p>From the Tidyverse style guide:</p>
<blockquote>
<p>In data analysis code, use comments to record important findings and
analysis decisions. If you need comments to explain what your code is
doing, consider rewriting your code to be clearer. If you discover that
you have more comments than code, consider switching to R Markdown.</p>
</blockquote>
</div>
</div>
<div id="utilizing-existing-libraries" class="section level2">
<h2>Utilizing existing libraries</h2>
<ul>
<li>Avoid reinventing the wheel</li>
<li>Keeps projects “modular”</li>
<li>Others may already be familiar with code from popular packages</li>
</ul>
<div id="great-packages-to-be-aware-of" class="section level3">
<h3>Great packages to be aware of</h3>
<ul>
<li><a href="https://www.tidyverse.org/">Tidyverse</a>
<ul>
<li>“metapackage”</li>
<li>installs a collection of libraries that all have similar syntax</li>
<li>data import, cleaning, visualization, and wrangling</li>
<li>useful programming tools (glue, magrittr, purrr)</li>
</ul></li>
<li><a href="http://fable.tidyverts.org/">fable</a>
<ul>
<li>used for time series modeling and analysis</li>
<li>has an associated online book: <a
href="https://otexts.com/fpp3/">Forecasting: Principles and
Practice</a></li>
<li>replaces the older <a
href="https://pkg.robjhyndman.com/forecast/">forecast</a> library
(fpp2)</li>
</ul></li>
<li><a href="https://cran.r-project.org/web/packages/zoo/">zoo</a>
<ul>
<li>a different and popular time series package</li>
</ul></li>
<li><a href="https://topepo.github.io/caret/">caret</a>
<ul>
<li>a set of functions that attempt to streamline the process for
creating predictive models</li>
</ul></li>
<li><a href="https://mc-stan.org/rstanarm/">rstanarm</a> and <a
href="https://mc-stan.org/rstan/">rstan</a>
<ul>
<li>comprehensive Bayesian modeling and inference</li>
<li>visualization packages like <a
href="https://mc-stan.org/bayesplot/">bayesplot</a></li>
<li>cross validation via <a href="https://mc-stan.org/loo/">loo</a></li>
</ul></li>
<li>rmarkdown, knitr, bookdown, posterdown, …
<ul>
<li>packages for creating elegant reports, slides, posters, and more
using R and Markdown</li>
<li>kableExtra: for creating pretty tables</li>
<li>patchwork: for arranging ggplots</li>
</ul></li>
<li><a
href="https://www.computerworld.com/article/2921176/great-r-packages-for-data-import-wrangling-visualization.html">Great
R packages for data import, wrangling and visualization</a></li>
</ul>
</div>
</div>
<div id="data-is-immutable" class="section level2">
<h2>Data is immutable</h2>
<p>What does immutable mean to you?</p>
<p>Raw data should STAY raw data.</p>
<p>[example given during lecture using psychometric data]</p>
<div id="large-file-storage" class="section level3">
<h3>Large File Storage</h3>
<p>github is great at tracking changes made to code and documents, but
what if that code produces large image or video files? Or you have
massive Illumina datasets that you canot store on github?</p>
<ul>
<li>Git Large File Storage Git Large File Storage (LFS) replaces large
files such as audio samples, videos, datasets, and graphics with text
pointers inside Git, while storing the file contents on a remote server
like GitHub.com or GitHub Enterprise.</li>
</ul>
<p>If you have git, using their large file storage works very similarly.
First, set up your account to use LFS by running (from the command
line):</p>
<pre class="bash"><code>git lfs install</code></pre>
<p>In each Git repository where you want to use Git LFS, select the file
types you’d like Git LFS to manage (or directly edit your
.gitattributes). You can configure additional file extensions at
anytime.</p>
<pre class="bash"><code>git lfs track &quot;*.psd&quot;
# make sure .gitattributes is tracked
git add .gitattributes</code></pre>
<p>Note: That defining the file types Git LFS should track will not, by
itself, convert any pre-existing files to Git LFS, such as files on
other branches or in your prior commit history</p>
<p>Now, just commit and push to github as you normally would:</p>
<pre class="bash"><code>git add file.psd
git commit -m &quot;Add design file&quot;
git push origin main</code></pre>
<p><strong>Box</strong></p>
<p>If you have a UNR email address, you automatically have box storage
that is available to you. Box is great for storing all of your files in
one place, and does actively track changes made to your files that can
easily be reversed by you or someone that you have shared the directory
with.</p>
<p>This type of storage can reliably track any changes that have been
made to your large files over the course of your project and helps in
avoiding a directory that looks like: gif_v1, gif_v2, gif_v3, etc.</p>
</div>
</div>
<div id="dynamic-documents-and-reports" class="section level2">
<h2>Dynamic documents and reports</h2>
<div id="r-markdown" class="section level3">
<h3>R Markdown</h3>
<p>[in session example from scratch]</p>
</div>
<div id="r-markdown-presentations" class="section level3">
<h3>R Markdown Presentations</h3>
<ul>
<li><a
href="https://github.com/adknudson/UNR-Masters-Thesis/blob/master/presentation/defense_presentation.Rmd"
class="uri">https://github.com/adknudson/UNR-Masters-Thesis/blob/master/presentation/defense_presentation.Rmd</a></li>
</ul>
</div>
<div id="bookdown" class="section level3">
<h3>Bookdown</h3>
<p>[in session overview including examples]</p>
<ul>
<li>This workshop series</li>
<li>My UNR thesis</li>
</ul>
</div>
<div id="posterdown" class="section level3">
<h3>Posterdown</h3>
<p>[in session example]</p>
<ul>
<li><a href="https://github.com/adknudson/tramm"
class="uri">https://github.com/adknudson/tramm</a></li>
</ul>
</div>
</div>




</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.odd').parent('tbody').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- tabsets -->

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open');
  });
});
</script>

<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
